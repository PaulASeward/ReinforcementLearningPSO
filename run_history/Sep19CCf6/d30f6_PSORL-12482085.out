[reverb/cc/platform/tfrecord_checkpointer.cc:150]  Initializing TFRecordCheckpointer in /tmp/tmpclgnu5q5.
[reverb/cc/platform/tfrecord_checkpointer.cc:386] Loading latest checkpoint from /tmp/tmpclgnu5q5
[reverb/cc/platform/default/server.cc:71] Started replay server on port 39186
2023-09-18 17:12:33.468349: W tensorflow/python/util/util.cc:368] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
[reverb/cc/client.cc:165] Sampler and server are owned by the same process (20355) so Table uniform_table is accessed directly without gRPC.
WARNING:tensorflow:From /scratch/pseward/TF_RL/lib/python3.10/site-packages/tensorflow/python/util/dispatch.py:1082: calling foldr_v2 (from tensorflow.python.ops.functional_ops) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.foldr(fn, elems, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.foldr(fn, elems))
WARNING:tensorflow:From /scratch/pseward/TF_RL/lib/python3.10/site-packages/tensorflow/python/util/dispatch.py:1082: calling foldr_v2 (from tensorflow.python.ops.functional_ops) with back_prop=False is deprecated and will be removed in a future version.
Instructions for updating:
back_prop=False is deprecated. Consider using tf.stop_gradient instead.
Instead of:
results = tf.foldr(fn, elems, back_prop=False)
Use:
results = tf.nest.map_structure(tf.stop_gradient, tf.foldr(fn, elems))
num_actions: 5
step = 200: loss = 462054.75
step = 400: loss = 6161194.0
step = 500: Average Return = [-36.647488]
step = 600: loss = 5866473.0
step = 800: loss = 1137232.875
step = 1000: loss = 804518.5
step = 1000: Average Return = [-54.613014]
step = 1200: loss = 306495.40625
step = 1400: loss = 229456.4375
step = 1500: Average Return = [-34.658054]
step = 1600: loss = 93262.875
step = 1800: loss = 167528.625
step = 2000: loss = 124464.875
step = 2000: Average Return = [-33.424103]
step = 2200: loss = 58640.4921875
step = 2400: loss = 50655.265625
step = 2500: Average Return = [-20.212671]
step = 2600: loss = 113012.8828125
step = 2800: loss = 62295.6875
step = 3000: loss = 35419.5703125
step = 3000: Average Return = [-30.623835]
step = 3200: loss = 30824.775390625
step = 3400: loss = 186676.625
step = 3500: Average Return = [-22.08398]
step = 3600: loss = 67831.234375
step = 3800: loss = 26269320.0
step = 4000: loss = 39870.984375
step = 4000: Average Return = [-31.993954]
step = 4200: loss = 4671371.5
step = 4400: loss = 88251.9375
step = 4500: Average Return = [-24.905554]
step = 4600: loss = 158337.890625
step = 4800: loss = 23356.759765625
step = 5000: loss = 20344.96875
step = 5000: Average Return = [-27.433857]
step = 5200: loss = 81440.390625
step = 5400: loss = 17947.69921875
step = 5500: Average Return = [-38.224766]
step = 5600: loss = 11795.103515625
step = 5800: loss = 3697.24365234375
step = 6000: loss = 2195.944091796875
step = 6000: Average Return = [-15.769545]
step = 6200: loss = 2741.8408203125
step = 6400: loss = 1902.3369140625
step = 6500: Average Return = [-21.719696]
step = 6600: loss = 3089.58447265625
step = 6800: loss = 4386.4658203125
step = 7000: loss = 4155.9404296875
step = 7000: Average Return = [-40.85725]
step = 7200: loss = 888.8773193359375
step = 7400: loss = 2532.2978515625
step = 7500: Average Return = [-17.559376]
step = 7600: loss = 1897.5819091796875
step = 7800: loss = 2227.91650390625
step = 8000: loss = 1108.0606689453125
step = 8000: Average Return = [-23.733448]
step = 8200: loss = 1503.728515625
step = 8400: loss = 3489.81201171875
step = 8500: Average Return = [-40.94591]
step = 8600: loss = 1983.5133056640625
step = 8800: loss = 1335.5958251953125
step = 9000: loss = 2011.8497314453125
step = 9000: Average Return = [-30.955826]
step = 9200: loss = 1879.1102294921875
step = 9400: loss = 1095.4605712890625
step = 9500: Average Return = [-36.309044]
step = 9600: loss = 1696.738525390625
step = 9800: loss = 1576.0244140625
step = 10000: loss = 862.1331787109375
step = 10000: Average Return = [-53.67399]
step = 10200: loss = 1271.1885986328125
step = 10400: loss = 1217.917724609375
step = 10500: Average Return = [-32.835217]
step = 10600: loss = 3596.99853515625
step = 10800: loss = 570.1356201171875
step = 11000: loss = 985.9100341796875
step = 11000: Average Return = [-15.3214445]
step = 11200: loss = 2377.276611328125
step = 11400: loss = 808.2284545898438
step = 11500: Average Return = [-15.898394]
step = 11600: loss = 713.6089477539062
step = 11800: loss = 660.1341552734375
step = 12000: loss = 1112.589111328125
step = 12000: Average Return = [-19.315386]
step = 12200: loss = 1169.9923095703125
step = 12400: loss = 875.68017578125
step = 12500: Average Return = [-48.141544]
step = 12600: loss = 1601.29541015625
step = 12800: loss = 618.89453125
step = 13000: loss = 525.8365478515625
step = 13000: Average Return = [-21.644825]
step = 13200: loss = 543.3658447265625
step = 13400: loss = 489.44232177734375
step = 13500: Average Return = [-28.277405]
step = 13600: loss = 670.381591796875
step = 13800: loss = 468.09881591796875
step = 14000: loss = 581.1990966796875
step = 14000: Average Return = [-26.535425]
step = 14200: loss = 324.4024658203125
step = 14400: loss = 595.1640625
step = 14500: Average Return = [-23.112637]
step = 14600: loss = 382.4149169921875
step = 14800: loss = 329.5445251464844
step = 15000: loss = 330.45770263671875
step = 15000: Average Return = [-20.812115]
step = 15200: loss = 260.3162841796875
step = 15400: loss = 417.1534118652344
step = 15500: Average Return = [-53.48482]
step = 15600: loss = 512.7442016601562
step = 15800: loss = 327.97662353515625
step = 16000: loss = 686.7456665039062
step = 16000: Average Return = [-14.537578]
step = 16200: loss = 529.90625
step = 16400: loss = 453.0493469238281
step = 16500: Average Return = [-20.548409]
step = 16600: loss = 419.4203796386719
step = 16800: loss = 469.87152099609375
step = 17000: loss = 221.83929443359375
step = 17000: Average Return = [-14.868492]
step = 17200: loss = 257.290283203125
step = 17400: loss = 818.9028930664062
step = 17500: Average Return = [-44.331215]
step = 17600: loss = 411.64654541015625
step = 17800: loss = 176.4291534423828
step = 18000: loss = 915.6280517578125
step = 18000: Average Return = [-22.533642]
step = 18200: loss = 884.4244384765625
step = 18400: loss = 584.9198608398438
step = 18500: Average Return = [-21.674503]
step = 18600: loss = 916.59326171875
step = 18800: loss = 399.64447021484375
step = 19000: loss = 774.6407470703125
step = 19000: Average Return = [-14.652949]
step = 19200: loss = 624.550048828125
step = 19400: loss = 361.077880859375
step = 19500: Average Return = [-14.060326]
step = 19600: loss = 345.43743896484375
step = 19800: loss = 543.2996215820312
step = 20000: loss = 427.8831787109375
step = 20000: Average Return = [-31.85733]
--- Execution took 10.522951930231518 hours ---
[reverb/cc/platform/default/server.cc:84] Shutting down replay server
